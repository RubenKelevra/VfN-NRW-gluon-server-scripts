router id ROUTERID;
listen bgp address ROUTERID port 179;
log syslog { debug, trace, info, remote, warning, error, auth, fatal, bug };

# Define the public_filter route filter...
filter foreign_peer_block_own_nets {
	#REJECT OWN NETS!
	#=+1# #inputlocator
	else accept;
}

filter bad_net_filter {
	#RFC 1918
	if net ~ 10.0.0.0/8 then accept;
	if net ~ 172.16.0.0/12 then accept;
	if net ~ 192.168.0.0/16 then accept;
	#known-nets
	if net ~ 46.4.248.192/27 then accept;
	if net ~ 185.28.77.192/27 then accept;
	if net ~ 192.175.48.0/24 then accept;
	#known-nets which we reject
	if net ~ 104.0.0.0/11 then reject;
	if net ~ 104.32.0.0/12 then reject;
	if net ~ 104.59.246.0/24 then reject;
	if net ~ 104.61.0.0/16 then reject;
	if net ~ 104.62.0.0/16 then reject;
	if net ~ 104.64.0.0/10 then reject;
	if net ~ 104.128.0.0/9 then reject;

	else reject;
}


protocol kernel kffwk {
	import all;
	export filter bad_net_filter;
	learn;
	scan time 10;
	kernel table 43;
}

protocol static icvpn { #reject own ip spaces via alias icvpn; announce this
	#=+2# #inputlocator
}

protocol device { #scan time for changes in table 43
	scan time 10;
}

protocol bgp augsburg1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.17 as 65050;
}


protocol bgp augsburg2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.68 as 65050;
}


protocol bgp basel1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.5.1 as 65090;
}


protocol bgp bayreuth {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.28 as 65025;
}


protocol bgp berlin1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.5 as 44194;
}


protocol bgp berlin2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.6 as 44194;
}


protocol bgp bielefeld1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.59 as 65529;
}


protocol bgp bielefeld2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.67 as 65529;
}


protocol bgp braunschweig1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.40 as 65380;
}


protocol bgp braunschweig2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.41 as 65380;
}


protocol bgp bremen1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.196 as 65196;
}


protocol bgp bremen2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.196 as 65196;
}


protocol bgp chemnitz1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.36 as 65053;
}


protocol bgp darmstadt1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.218 as 65038;
}


protocol bgp darmstadt2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.219 as 65038;
}


protocol bgp diepholz1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.12 as 65501;
}


protocol bgp dreilaendereck1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.75 as 65043;
}


protocol bgp dreilaendereck2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.74 as 65043;
}


protocol bgp dreilaendereck3 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.72 as 65043;
}


protocol bgp dresden1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.19 as 65051;
}


protocol bgp dresden2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.20 as 65051;
}


protocol bgp ehingen1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.45 as 65535;
}


protocol bgp erfurt1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.9 as 65099;
}


protocol bgp erfurt2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.10 as 65099;
}


protocol bgp flensburg1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.129 as 65056;
}


protocol bgp flensburg2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.128 as 65056;
}


protocol bgp franken_ro1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.23 as 65024;
}


protocol bgp frankfurt1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.35 as 65026;
}


protocol bgp freiburg1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.21 as 65060;
}


protocol bgp goettingen1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.65 as 65527;
}


protocol bgp graz1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.2 as 65048;
}


protocol bgp graz2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.3 as 65048;
}


protocol bgp guetersloh1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.132 as 65533;
}


protocol bgp guetersloh2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.133 as 65533;
}


protocol bgp guetersloh4 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.134 as 65533;
}


protocol bgp halle1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.13 as 65046;
}


protocol bgp halle2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.14 as 65046;
}


protocol bgp hamburg01 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.61 as 49009;
}


protocol bgp hamburg02 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.64 as 49009;
}


protocol bgp hamburg03 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.63 as 49009;
}


protocol bgp hannover1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.22 as 65511;
}


protocol bgp jena1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.33 as 65055;
}


protocol bgp jena2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.66 as 65055;
}


protocol bgp karlsruhe1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.214 as 65081;
}


protocol bgp karlsruhe2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.214 as 65081;
}


protocol bgp koeln1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.57 as 65528;
}


protocol bgp koblenz {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.32 as 65032;
}


protocol bgp leipzig1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.1 as 65041;
}


protocol bgp leipzig2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.2 as 65041;
}


protocol bgp ljubljana1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.3.23 as 65023;
}


protocol bgp ljubljana2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.3.30 as 65023;
}


protocol bgp luebeck1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.130 as 65052;
}


protocol bgp luebeck2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.131 as 65052;
}


protocol bgp luenen {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.34 as 65034;
}


protocol bgp magdeburg1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.39.1 as 65039;
}


protocol bgp magdeburg2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.39.2 as 65039;
}


protocol bgp mainz2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.37 as 65037;
}


protocol bgp moehne003 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.121 as 65057;
}


protocol bgp moehne1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.120 as 65057;
}


protocol bgp moehne103 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.122 as 65057;
}


protocol bgp muenchen1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor ROUTERID0 as 65080;
}


protocol bgp muenchen4 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.4.80 as 65080;
}


protocol bgp muenster1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.43 as 65251;
}


protocol bgp mueritz_bgp1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.138 as 65534;
}


protocol bgp nordwest1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.27 as 65513;
}


protocol bgp nordwest2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.38 as 65513;
}


protocol bgp nordwest3 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.39 as 65513;
}


protocol bgp ostholstein1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.135 as 65152;
}


protocol bgp paderborn01 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.231 as 65132;
}


protocol bgp paderborn02 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.232 as 65132;
}


protocol bgp rhein_neckar {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.142 as 76118;
}


protocol bgp rheinufer1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.76 as 65078;
}


protocol bgp rheinufer3 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.77 as 65078;
}


protocol bgp ruhrgebiet1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.79 as 65079;
}


protocol bgp treuenbrietzen {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.18 as 65045;
}


protocol bgp trier1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.220 as 65022;
}


protocol bgp trier2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.221 as 65022;
}


protocol bgp weimar1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.3 as 65042;
}


protocol bgp weimar2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.4 as 65042;
}


protocol bgp westpfalz1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor ROUTERID5 as 65242;
}


protocol bgp schilcher1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.51 as 65054;
}


protocol bgp wiesbaden1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.56 as 65036;
}


protocol bgp wiesbaden2 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.1.56 as 65036;
}


protocol bgp wuppertal1 {
	import filter foreign_peer_block_own_nets;	
	export where proto = "icvpn";	
	source address ROUTERID;	
	local as 65530;
	neighbor 10.207.0.73 as 65523;
}
